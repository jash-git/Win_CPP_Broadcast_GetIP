(function(){var viewportWidth=0,viewportHeight=0,frameType=null,topFrame=null,parentTimes=0,fid=null,isActive=false,isChechTimeUp=false,activeStartTime=0,activeEndTime=0,creativeFrame=null,timer=null,checkType="top",curtop=0,frameTop=0,frameHeight=0,activeTop=0,frameBottom=0,checkDisplay=true,activebottom=0;function getStyle(element,attr){if(element.currentStyle){return element.currentStyle[attr]}else{return window.getComputedStyle(element,null)[attr]}}function getParentNode(ojb){try{var prantNd=ojb.parentNode;if(prantNd!=null&&typeof(prantNd)!="undefined"&&prantNd!==topFrame.document){display=getStyle(prantNd,"display");if(display=="none"){checkDisplay=false;return false}getParentNode(prantNd)}}catch(e){}}function getParent(thisFrame){if(thisFrame!=top&&parentTimes<=10){parentTimes++;if(typeof(thisFrame.frameElement)!="undefined"&&thisFrame.frameElement!==null&&typeof(thisFrame.frameElement.id)!="undefined"){fid=thisFrame.frameElement.id;creativeFrame=thisFrame;if(fid.indexOf("cfadif")!=-1){frameType="clickforce"}else{if(fid.indexOf("google_ads")!=-1){frameType="google"}else{frameType="other"}}topFrame=thisFrame.parent;if(topFrame!=top){getParent(topFrame)}}else{frameType="cross Domain frame"}}}function getParentOT(obj,body){if(obj.offsetParent){curtop+=obj.offsetParent.offsetTop;getParentOT(obj.offsetParent,body)}}function getViewSize(){if(typeof window.innerWidth!="undefined"){viewportWidth=topFrame.window.innerWidth,viewportHeight=topFrame.window.innerHeight}else{if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!=0){viewportWidth=topFrame.document.documentElement.clientWidth,viewportHeight=topFrame.document.documentElement.clientHeight}else{viewportWidth=topFrame.document.getElementsByTagName("body")[0].clientWidth,viewportHeight=topFrame.document.getElementsByTagName("body")[0].clientHeight}}}function sendLog(type){if(typeof(p)!="undefined"){var sc=document.createElement("script");sc.src="//ad.doublemax.net/adserver/av?p="+p+"&type="+type;document.body.appendChild(sc)}}function setActive(){if(isActive===false){isActive=true;sendLog(1)}}function chechkByTwoSec(){if(isChechTimeUp===true){setActive()}else{timer=null}}function scrollEvent(){if(isActive===false){var scrollTop=(topFrame.window.pageYOffset||topFrame.document.documentElement.scrollTop)-(topFrame.document.documentElement.clientTop||0);var scrollBottom=scrollTop+viewportHeight;if(scrollTop<activeTop&&scrollBottom>activeTop){if(isChechTimeUp===false){isChechTimeUp=true;if(timer===null){timer=setTimeout(function(){checkDisplay=true;var cd=getParentNode(creativeFrame.frameElement);if(checkDisplay===true){chechkByTwoSec()}else{timer=null;scrollEvent()}},1000)}}}else{if(isChechTimeUp===true){isChechTimeUp=false}}}}function reSetEventSize(){if(isActive===false){if(typeof creativeFrame!="undefined"&&typeof creativeFrame.frameElement!="undefined"&&typeof targetFrame!="undefined"){getViewSize();curtop=0;getParentOT(targetFrame,topFrame.document.body);frameTop=targetFrame.offsetTop+curtop;if(creativeFrame.frameElement!=null){frameHeight=(parseInt(creativeFrame.frameElement.height)||parseInt(creativeFrame.frameElement.clientHeight));activeTop=frameTop+(frameHeight*0.5);lazyLoadTop=frameTop-150;if(lazyLoadTop<0){lazyLoadTop=0}frameBottom=frameTop+(frameHeight*1);activebottom=frameBottom-(frameHeight*0.5)}}}}getParent(self);if(frameType!==null&&frameType!="cross Domain frame"){var pageFrame=topFrame.document.getElementsByTagName("iframe");var targetFrame=null;for(var i=0;i<pageFrame.length;i++){if(pageFrame[i]==creativeFrame.frameElement){targetFrame=pageFrame[i]}}reSetEventSize();scrollEvent();topFrame.addEventListener("resize",function(){reSetEventSize()});topFrame.addEventListener("scroll",function(){scrollEvent()});setTimeout(function(){reSetEventSize()},500);setTimeout(function(){reSetEventSize()},1000);setTimeout(function(){reSetEventSize()},2000)}else{sendLog(0)}})();